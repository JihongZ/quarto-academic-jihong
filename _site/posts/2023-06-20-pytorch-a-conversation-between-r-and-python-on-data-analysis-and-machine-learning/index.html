<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jihong Zhang">
<meta name="dcterms.date" content="2023-06-20">
<title>Dr.&nbsp;Jihong Zhang - A Conversation between R and Python on Data Analysis and Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../icon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-149871707-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="../../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script><script src="../../site_libs/vega-5.22.0/vega@5.22.0.min.js"></script><script src="../../site_libs/vega-lite-5.5.0/vega-lite@5.5.0.min.js"></script><link href="../../site_libs/vega-embed-6.20.8/vega-embed.css" rel="stylesheet">
<script src="../../site_libs/vega-embed-6.20.8/vega-embed@6.20.8.min.js"></script><script src="../../site_libs/vegawidget-vl5-binding-0.4.2.9000/vegawidget-vl5.js"></script><link href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@500&amp;family=Oxygen+Mono&amp;family=Ysabeau+Office&amp;display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/key-buttons.min.js" defer=""></script><link href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/key-buttons.min.css" rel="stylesheet">
<meta property="og:title" content="Dr.&nbsp;Jihong Zhang - A Conversation between R and Python on Data Analysis and Machine Learning">
<meta property="og:description" content="">
<meta property="og:image" content="https://jihongzhang.org/posts/2023-06-20-pytorch-a-conversation-between-r-and-python-on-data-analysis-and-machine-learning/reticulated_python.png">
<meta property="og:site-name" content="Dr. Jihong Zhang">
<meta property="og:image:height" content="516">
<meta property="og:image:width" content="739">
<meta name="twitter:title" content="Dr.&nbsp;Jihong Zhang - A Conversation between R and Python on Data Analysis and Machine Learning">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://jihongzhang.org/posts/2023-06-20-pytorch-a-conversation-between-r-and-python-on-data-analysis-and-machine-learning/reticulated_python.png">
<meta name="twitter:creator" content="@jihongzgamma">
<meta name="twitter:image-height" content="516">
<meta name="twitter:image-width" content="739">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target=""><i class="bi bi-bi bi-house" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../posts.html" rel="" target="" aria-current="page"><i class="bi bi-bi bi-file-post-fill" role="img">
</i> 
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
      <i class="bi bi-bi bi-three-dots-vertical" role="img">
</i> 
 <span class="menu-text">More</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-more">
<li>
    <a class="dropdown-item" href="../../projects.html" rel="" target="">
 <span class="dropdown-text">Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../links.html" rel="" target="">
 <span class="dropdown-text">About</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">A Conversation between R and Python on Data Analysis and Machine Learning</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Contents</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Blog</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-07-04-data-visualization-for-survey-data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data visualization for survey data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-14-how-to-use-uark-hpc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to set up High Performance Computing of U of Ark</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-06-26-moving-to-quarto/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Moving My Website to Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2022-10-23-thesis-defense/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dissertation Defence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-06-26-analyze-my-apple-health-data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analyze Apple Health data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-06-27-one-template-for-quarto-report/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">One Template for Quarto Report</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-07-07-communities-in-psychometric-networks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communities in psychometric networks?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2023-06-28-a-tutorial-for-forester-r-package/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A tutorial for forester R package</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ESRM 6553: Adv. Multivariate</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 ">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Lecture01</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth4 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture01/Lecture01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 01</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Lecture02</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth4 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/2024-01-12-syllabus-adv-multivariate-esrm-6553/Lecture02/Lecture02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 02</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
      </ul>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#pytorch-tensor" id="toc-pytorch-tensor" class="nav-link active" data-scroll-target="#pytorch-tensor"><span class="header-section-number">1</span> PyTorch Tensor</a>
  <ul class="collapse">
<li><a href="#arithmetic-operations" id="toc-arithmetic-operations" class="nav-link" data-scroll-target="#arithmetic-operations"><span class="header-section-number">1.1</span> Arithmetic operations</a></li>
  <li><a href="#more-examples-of-the-matrix-operations" id="toc-more-examples-of-the-matrix-operations" class="nav-link" data-scroll-target="#more-examples-of-the-matrix-operations"><span class="header-section-number">1.2</span> More examples of the matrix operations:</a></li>
  <li><a href="#listwise-computation" id="toc-listwise-computation" class="nav-link" data-scroll-target="#listwise-computation"><span class="header-section-number">1.3</span> listwise computation</a></li>
  </ul>
</li>
  <li><a href="#import-tensor-to-r" id="toc-import-tensor-to-r" class="nav-link" data-scroll-target="#import-tensor-to-r"><span class="header-section-number">2</span> Import tensor to R</a></li>
  <li><a href="#mixture-of-r-and-python-visualization" id="toc-mixture-of-r-and-python-visualization" class="nav-link" data-scroll-target="#mixture-of-r-and-python-visualization"><span class="header-section-number">3</span> Mixture of R and Python: visualization</a></li>
  <li><a href="#pure-r-torch-for-r" id="toc-pure-r-torch-for-r" class="nav-link" data-scroll-target="#pure-r-torch-for-r"><span class="header-section-number">4</span> Pure R: torch for R</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">A Conversation between R and Python on Data Analysis and Machine Learning</h1>
  <div class="quarto-categories">
    <div class="quarto-category">blog</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">PyTorch</div>
    <div class="quarto-category">Deep Learning</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jihong Zhang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><blockquote class="blockquote">
<p>When I play with machine learning using python and R, I keep wondering whether I can combine R and Python code in a better way, such as using R for data cleaning/visualization and Python for machine learning. Online resources for PyTorch are basically written using python code. However, I always struggle with pandas and numpy but prefer tidyverse for data cleaning, and data manipulation. That’s why I write this blog. I will start with the Pytorch tensor manipulation and import Pytorch tensor into R, then talk about mixing R/python data analysis with R/python visualization.</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="reticulated_python.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">reticulate package logo</figcaption></figure>
</div>
<section id="pytorch-tensor" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="pytorch-tensor">
<span class="header-section-number">1</span> PyTorch Tensor</h2>
<p>Let’s first get familiar with data manipulation using <em>PyTorch</em>. First, <code>torch.zeors(R, C)</code> function can create a zero tensor with the size of R by C.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python, echo = "fenced"}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> torch.zeros(<span class="dv">5</span>, <span class="dv">3</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.],
&gt;&gt;         [0., 0., 0.]])</code></pre>
</div>
</div>
<p>Similarly, <code>torch.ones(R, C)</code> creates a tensor filled with ones with the size of R by C with <code>dtype=torch.int16</code> argument can coverting elements into integer.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> torch.ones((<span class="dv">5</span>,<span class="dv">3</span>), dtype<span class="op">=</span>torch.int16)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(i)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1],
&gt;&gt;         [1, 1, 1]], dtype=torch.int16)</code></pre>
</div>
</div>
<p>We can generate random numbers to tensor using <code>torch.rand(R, C)</code>. It’s recommended to set up a random seed using <code>torch.manual_seed(seed_num)</code> to make sure we can replicate our random tensor.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">1729</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>r1 <span class="op">=</span> torch.rand(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'A random tensor:</span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>r1<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; &lt;torch._C.Generator object at 0x10d9e4cf0&gt;
&gt;&gt; A random tensor:
&gt;&gt;  tensor([[0.3126, 0.3791],
&gt;&gt;         [0.3087, 0.0736]])</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> torch.arange(<span class="dv">4</span> <span class="op">*</span> <span class="dv">5</span> <span class="op">*</span> <span class="dv">6</span>).view(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"A sequence of number arraged to 4 matrix of the size 5 X 6: </span><span class="ch">\n</span><span class="sc">{</span>b<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span> )</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; A sequence of number arraged to 4 matrix of the size 5 X 6: 
&gt;&gt; tensor([[[  0,   1,   2,   3,   4,   5],
&gt;&gt;          [  6,   7,   8,   9,  10,  11],
&gt;&gt;          [ 12,  13,  14,  15,  16,  17],
&gt;&gt;          [ 18,  19,  20,  21,  22,  23],
&gt;&gt;          [ 24,  25,  26,  27,  28,  29]],
&gt;&gt; 
&gt;&gt;         [[ 30,  31,  32,  33,  34,  35],
&gt;&gt;          [ 36,  37,  38,  39,  40,  41],
&gt;&gt;          [ 42,  43,  44,  45,  46,  47],
&gt;&gt;          [ 48,  49,  50,  51,  52,  53],
&gt;&gt;          [ 54,  55,  56,  57,  58,  59]],
&gt;&gt; 
&gt;&gt;         [[ 60,  61,  62,  63,  64,  65],
&gt;&gt;          [ 66,  67,  68,  69,  70,  71],
&gt;&gt;          [ 72,  73,  74,  75,  76,  77],
&gt;&gt;          [ 78,  79,  80,  81,  82,  83],
&gt;&gt;          [ 84,  85,  86,  87,  88,  89]],
&gt;&gt; 
&gt;&gt;         [[ 90,  91,  92,  93,  94,  95],
&gt;&gt;          [ 96,  97,  98,  99, 100, 101],
&gt;&gt;          [102, 103, 104, 105, 106, 107],
&gt;&gt;          [108, 109, 110, 111, 112, 113],
&gt;&gt;          [114, 115, 116, 117, 118, 119]]])</code></pre>
</div>
</div>
<section id="arithmetic-operations" class="level3" data-number="1.1"><h3 data-number="1.1" class="anchored" data-anchor-id="arithmetic-operations">
<span class="header-section-number">1.1</span> Arithmetic operations</h3>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ones <span class="op">=</span> torch.ones(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First tensor: </span><span class="ch">\n</span><span class="sc">{</span>ones<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>twos <span class="op">=</span> torch.ones(<span class="dv">2</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">2</span> <span class="co"># multiple each element by 2</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Second tensor: </span><span class="ch">\n</span><span class="sc">{</span>twos<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>threes <span class="op">=</span> ones <span class="op">+</span> twos <span class="co"># addition allowed when shapes of two tensors are similar</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Third tensor: </span><span class="ch">\n</span><span class="sc">{</span>threes<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; First tensor: 
&gt;&gt; tensor([[1., 1., 1.],
&gt;&gt;         [1., 1., 1.]])
&gt;&gt; 
&gt;&gt; Second tensor: 
&gt;&gt; tensor([[2., 2., 2.],
&gt;&gt;         [2., 2., 2.]])
&gt;&gt; 
&gt;&gt; Third tensor: 
&gt;&gt; tensor([[3., 3., 3.],
&gt;&gt;         [3., 3., 3.]])</code></pre>
</div>
</div>
</section><section id="more-examples-of-the-matrix-operations" class="level3" data-number="1.2"><h3 data-number="1.2" class="anchored" data-anchor-id="more-examples-of-the-matrix-operations">
<span class="header-section-number">1.2</span> More examples of the matrix operations:</h3>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">1729</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> (torch.rand(<span class="dv">2</span>, <span class="dv">2</span>) <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'A random matrix: </span><span class="ch">\n</span><span class="sc">{</span>a<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>a_abs <span class="op">=</span> torch.<span class="bu">abs</span>(a) <span class="co"># Absolute values for elements</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'A absolute matrix: </span><span class="ch">\n</span><span class="sc">{</span>a_abs<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>a_asin <span class="op">=</span> torch.asin(a) <span class="co"># trigonometric functions</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Inverse sine of r: </span><span class="ch">\n</span><span class="sc">{</span>a_asin<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>a_det <span class="op">=</span> torch.det(a) <span class="co"># Determinant and singular value decomposition</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Determinant of r: </span><span class="ch">\n</span><span class="sc">{</span>a_det<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>a_svd <span class="op">=</span> torch.svd(a) </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Singlular value decomposition of r: </span><span class="ch">\n</span><span class="sc">{</span>a_svd<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>a_std_mean <span class="op">=</span> torch.std_mean(a) <span class="co"># Statistical and aggregate operations:</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Average and standard deviation of r: </span><span class="ch">\n</span><span class="sc">{</span>a_std_mean<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>a_max <span class="op">=</span> torch.<span class="bu">max</span>(a)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Maximum value of r: </span><span class="ch">\n</span><span class="sc">{</span>a_max<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; &lt;torch._C.Generator object at 0x10d9e4cf0&gt;
&gt;&gt; A random matrix: 
&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])
&gt;&gt; 
&gt;&gt; A absolute matrix: 
&gt;&gt; tensor([[0.3748, 0.2418],
&gt;&gt;         [0.3827, 0.8528]])
&gt;&gt; 
&gt;&gt; Inverse sine of r: 
&gt;&gt; tensor([[-0.3842, -0.2442],
&gt;&gt;         [-0.3927, -1.0214]])
&gt;&gt; 
&gt;&gt; Determinant of r: 
&gt;&gt; 0.22711339592933655
&gt;&gt; 
&gt;&gt; Singlular value decomposition of r: 
&gt;&gt; torch.return_types.svd(
&gt;&gt; U=tensor([[-0.3909, -0.9204],
&gt;&gt;         [-0.9204,  0.3909]]),
&gt;&gt; S=tensor([1.0111, 0.2246]),
&gt;&gt; V=tensor([[ 0.4933,  0.8699],
&gt;&gt;         [ 0.8699, -0.4933]]))
&gt;&gt; 
&gt;&gt; Average and standard deviation of r: 
&gt;&gt; (tensor(0.2678), tensor(-0.4630))
&gt;&gt; 
&gt;&gt; Maximum value of r: 
&gt;&gt; -0.24180912971496582</code></pre>
</div>
</div>
</section><section id="listwise-computation" class="level3" data-number="1.3"><h3 data-number="1.3" class="anchored" data-anchor-id="listwise-computation">
<span class="header-section-number">1.3</span> listwise computation</h3>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a_totalSum <span class="op">=</span> torch.<span class="bu">sum</span>(a)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'global sum of r: </span><span class="ch">\n</span><span class="sc">{</span>a_totalSum<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>a_rowSum <span class="op">=</span> torch.<span class="bu">sum</span>(a, dim<span class="op">=</span><span class="dv">1</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'row sums of r: </span><span class="ch">\n</span><span class="sc">{</span>a_rowSum<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>a_colSum <span class="op">=</span> torch.<span class="bu">sum</span>(a, dim<span class="op">=</span><span class="dv">0</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'column sums of r: </span><span class="ch">\n</span><span class="sc">{</span>a_colSum<span class="sc">}</span><span class="ch">\n</span><span class="ss">'</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; global sum of r: 
&gt;&gt; -1.852110505104065
&gt;&gt; 
&gt;&gt; row sums of r: 
&gt;&gt; tensor([[-0.6166],
&gt;&gt;         [-1.2355]])
&gt;&gt; 
&gt;&gt; column sums of r: 
&gt;&gt; tensor([[-0.7575, -1.0946]])</code></pre>
</div>
</div>
</section></section><section id="import-tensor-to-r" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="import-tensor-to-r">
<span class="header-section-number">2</span> Import tensor to R</h2>
<p>If you install <code>torch</code> package in R. You probably found that Pytorch’s tensor object can be called directly in R as <code>torch.Tensor</code>.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>a_inR <span class="ot">=</span> py<span class="sc">$</span>a</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(a_inR)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; [1] "torch.Tensor"          "torch._C._TensorBase"  "python.builtin.object"</code></pre>
</div>
</div>
<p>Unfortunately, it does not allow you to manipulate this tensor object directly using R function. For example, if you do matrix operation, it will pop up error message.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>a_inR <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>&gt;&gt; Error in a_inR * 2: non-numeric argument to binary operator</code></pre>
</div>
</div>
<p>However, you can use python method in R style (change <code>.</code> to <code>$</code>) as long as you load <code>reticulate</code> package. Like:</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>a_inR<span class="sc">$</span>shape</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>a_inR<span class="sc">$</span>data</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; torch.Size([2, 2])
&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])</code></pre>
</div>
</div>
<p>Can we import PyTorch tensor to R and employ R to do some dirty works, and then export it back to python? The answer is Yes (partially). We can try out this workflow: tensor -&gt; np.ndarray -&gt; R matrix -&gt; …(some manipulation) -&gt; np.ndarray -&gt; tensor (see diagram below). I’m not sure if it is worthy nor it is even plausible for more complicated tensor class. Note that it may make the memory stores at least three copies of the data. More experiments needed for such work. For more information about arrays in R and python, please refer to the <a href="https://rstudio.github.io/reticulate/articles/arrays.html">reticulate manual</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">graph LR;
    tensor--&gt;|np$array|np.ndarray;
    np.ndarray--&gt;|py_to_r|R.matrix;
    R.matrix --&gt;|some data manipulation|R.matrix;
    R.matrix--&gt;|r_to_py|np.ndarray;
    np.ndarray--&gt;|torch$from_numpy|tensor;
</pre>
</div>
</div>
</div>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"numpy"</span>, <span class="at">convert=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>a_data_inR <span class="ot">=</span> <span class="fu">py_to_r</span>(np<span class="sc">$</span><span class="fu">array</span>(a_inR<span class="sc">$</span>data))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>a_data_inR_revised <span class="ot">=</span> a_data_inR <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>a_inR <span class="co"># original python object in R</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>a_data_inR_revised <span class="co"># revised matrix in R</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[-0.3748, -0.2418],
&gt;&gt;         [-0.3827, -0.8528]])
&gt;&gt;            [,1]       [,2]
&gt;&gt; [1,] -0.7496002 -0.4836183
&gt;&gt; [2,] -0.7653229 -1.7056797</code></pre>
</div>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>torch <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"torch"</span>, <span class="at">convert=</span><span class="cn">FALSE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>a_inR<span class="sc">$</span>data <span class="ot">=</span> torch<span class="sc">$</span><span class="fu">from_numpy</span>(a_data_inR_revised)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>a_inR</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[-0.7496, -0.4836],
&gt;&gt;         [-0.7653, -1.7057]], dtype=torch.float64)</code></pre>
</div>
</div>
</section><section id="mixture-of-r-and-python-visualization" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="mixture-of-r-and-python-visualization">
<span class="header-section-number">3</span> Mixture of R and Python: visualization</h2>
<p>As mentioned above, the <code>reticulate</code> R package provides an R interface to Python modules, classes, and functions, which allows us to extend our graphical toolbox to all packages/modules of R and Python. Currently, we can use three methods of data visualization via mixing R code and Python code:</p>
<ul>
<li>R data + Python <code>matlibplot</code> module</li>
<li>Python data + Python <code>Vega-Altair</code> module + R output</li>
<li>Python data + R <code>ggplot2</code> package</li>
</ul>
<p>Let’s try them out one by one. First, take <code>iris</code> data in R for example:</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>iris_dat <span class="ot">=</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>iris_mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">unlist</span>(iris_dat), <span class="at">nrow =</span> <span class="fu">nrow</span>(iris), <span class="at">ncol =</span> <span class="fu">ncol</span>(iris_dat))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris_mat)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; [1] 150   3</code></pre>
</div>
</div>
<p>The column sums of iris are <code>c(876.5, 458.6, 564.7)</code> and the row sums of first 5 rows of iris are <code>c(10, 9.3, 9.2, 9.2, 10)</code>.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Columns Sums: {colSums(iris_mat)}'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'Row Sums: {rowSums(iris_mat[1:5, ])}'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; Columns Sums: 876.5
&gt;&gt; Columns Sums: 458.6
&gt;&gt; Columns Sums: 563.7
&gt;&gt; Row Sums: 10
&gt;&gt; Row Sums: 9.3
&gt;&gt; Row Sums: 9.2
&gt;&gt; Row Sums: 9.2
&gt;&gt; Row Sums: 10</code></pre>
</div>
</div>
<p>In Python chunk code of Rmarkdown, we can call data in R using <code>r.{dataname}</code>, in which <code>{dataname}</code> is the object name in R. Note that do not define <code>r</code> in python, otherwise <code>r</code> not longer become the R environment. Now we can load the R data frame in python. Please check <a href="https://rstudio.github.io/reticulate/">reticulate package</a> for more information about the rules of conversation between R and Python.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>iris_ndarray <span class="op">=</span> np.array(r.iris_mat)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>iris_tensor <span class="op">=</span> torch.from_numpy(iris_ndarray)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>torch.<span class="bu">sum</span>(iris_tensor, dim<span class="op">=</span><span class="dv">0</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>torch.<span class="bu">sum</span>(iris_tensor[:<span class="dv">5</span>,], dim<span class="op">=</span><span class="dv">1</span>, keepdim<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>&gt;&gt; tensor([[876.5000, 458.6000, 563.7000]], dtype=torch.float64)
&gt;&gt; tensor([[10.0000],
&gt;&gt;         [ 9.3000],
&gt;&gt;         [ 9.2000],
&gt;&gt;         [ 9.2000],
&gt;&gt;         [10.0000]], dtype=torch.float64)</code></pre>
</div>
</div>
<p>In Edgar Anderson’s <code>Iris</code> data, we can model a prediction model given the measurements in centimeters of sepal length/width, petal length/width and the three types of species: Iris <mark style="background-color:lightblue">setosa</mark>, <mark style="background-color:lightblue">versicolor</mark>, and <mark style="background-color:lightblue">virginica</mark>. Each type contains 50 samples. The very first question is then “can we train a machine learning algorithm to predict whether one belongs to Setosa/Versicolor/Virginica given four characteristics?” We can fit a multinomial regression to test statistical hypotheses of the characteristics’ differences among three species:</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-coef</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Coefficients of multinominal logistic regression</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>iris_new <span class="ot">=</span> iris <span class="sc">|&gt;</span> </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Species =</span> <span class="fu">relevel</span>(Species, <span class="st">"virginica"</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="do">## A multinominal logistic regression with Species-setosa as reference group</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(multinomial_fit <span class="ot">&lt;-</span> nnet<span class="sc">::</span><span class="fu">multinom</span>(Species <span class="sc">~</span> . <span class="sc">+</span> <span class="dv">0</span>, <span class="at">data =</span> iris_new, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">model =</span> <span class="cn">TRUE</span>),<span class="at">file =</span><span class="st">"/dev/null"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Print the coefficient table</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">tidy</span>(multinomial_fit, <span class="at">exponentiate =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">align =</span> <span class="st">"c"</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"DV"</span>, <span class="st">"IV"</span>, <span class="st">"b(logit)"</span>, <span class="st">"SE"</span>, <span class="st">"t.value"</span>, <span class="st">"p.value"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"condensed"</span>, <span class="st">"hover"</span>), <span class="at">html_font =</span> <span class="st">"Maven Pro"</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="tbl-coef" class="anchored">
<table class="table table-condensed table-hover table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;1: Coefficients of multinominal logistic regression</caption>
<thead><tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">DV</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">IV</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">b(logit)</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SE</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">t.value</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Sepal.Length</td>
<td style="text-align: center;">8.11</td>
<td style="text-align: center;">106.99</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.94</td>
</tr>
<tr class="even">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Sepal.Width</td>
<td style="text-align: center;">13.13</td>
<td style="text-align: center;">157.28</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.93</td>
</tr>
<tr class="odd">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Petal.Length</td>
<td style="text-align: center;">-18.55</td>
<td style="text-align: center;">76.14</td>
<td style="text-align: center;">-0.24</td>
<td style="text-align: center;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: center;">setosa</td>
<td style="text-align: center;">Petal.Width</td>
<td style="text-align: center;">-13.70</td>
<td style="text-align: center;">34.79</td>
<td style="text-align: center;">-0.39</td>
<td style="text-align: center;">0.69</td>
</tr>
<tr class="odd">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Sepal.Length</td>
<td style="text-align: center;">6.33</td>
<td style="text-align: center;">2.48</td>
<td style="text-align: center;">2.55</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Sepal.Width</td>
<td style="text-align: center;">6.62</td>
<td style="text-align: center;">2.53</td>
<td style="text-align: center;">2.62</td>
<td style="text-align: center;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Petal.Length</td>
<td style="text-align: center;">-8.44</td>
<td style="text-align: center;">3.47</td>
<td style="text-align: center;">-2.43</td>
<td style="text-align: center;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: center;">versicolor</td>
<td style="text-align: center;">Petal.Width</td>
<td style="text-align: center;">-10.28</td>
<td style="text-align: center;">3.46</td>
<td style="text-align: center;">-2.97</td>
<td style="text-align: center;">0.00</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>As shown in <a href="#tbl-coef">Table&nbsp;1</a> , it seems that multinominal logistic regression suggests none of the four features can significantly differentiate species but this could be misleading. This is because there are underlying correlations between sepal width/length and petal width/length. Next step is we can use <code>matplotlib</code> module to explore the relationships among four characteristics.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python, out.width = "80%", out.height = "100%", dpi = 200, fig.retina = 1}</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.cm <span class="im">as</span> cm</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>seaborn.<span class="bu">set</span>(style<span class="op">=</span><span class="st">'whitegrid'</span>)<span class="op">;</span> seaborn.set_context(<span class="st">'talk'</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>iris_data <span class="op">=</span> load_iris()</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>n_samples, n_features <span class="op">=</span> iris_data.data.shape</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Show_Diagram(x_label,y_label,title):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    plt.scatter(iris_data.data[:,x_label], iris_data.data[:,y_label], c<span class="op">=</span>iris_data.target, cmap<span class="op">=</span>cm.viridis, alpha <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> iris_data.target_names)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(iris_data.feature_names[x_label])<span class="op">;</span> plt.ylabel(iris_data.feature_names[y_label])<span class="op">;</span> plt.title(title)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    plt.legend((<span class="st">'setosa'</span>, <span class="st">'versicolor'</span>, <span class="st">'virginica'</span>))</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span>x_label <span class="op">=</span> <span class="dv">2</span><span class="op">;</span>y_label<span class="op">=</span><span class="dv">3</span><span class="op">;</span>title<span class="op">=</span><span class="st">'Petal'</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>Show_Diagram(<span class="dv">0</span>,<span class="dv">1</span>,<span class="st">'Sepal'</span>)</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>Show_Diagram(<span class="dv">2</span>,<span class="dv">3</span>,<span class="st">'Petal'</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" style="width:80.0%;height:100.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-2.png" style="width:80.0%;height:100.0%"></p>
</div>
</div>
<p>Alternatively, we can use python data and module <code>Vega-Altair</code> to compile a interactive graphical object to a json file (<code>.to_json()</code>). Then we can plot it in R using <code>as_vegaspec</code> function.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{python compile}</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># import altair with an abbreviated alias</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>label_dict <span class="op">=</span> {<span class="dv">0</span>: <span class="st">'setosa'</span>, <span class="dv">1</span>: <span class="st">'versicolor'</span>, <span class="dv">2</span>: <span class="st">'virginica'</span>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pd.DataFrame(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span> np.c_[iris_data[<span class="st">'data'</span>], iris_data[<span class="st">'target'</span>]],</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    columns<span class="op">=</span> iris_data[<span class="st">'feature_names'</span>] <span class="op">+</span> [<span class="st">'target'</span>]</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>iris[<span class="st">'target'</span>] <span class="op">=</span> iris[<span class="st">'target'</span>].replace(label_dict)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>chart1 <span class="op">=</span> alt.Chart(iris).mark_point().encode(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  alt.X(<span class="st">'sepal length (cm):Q'</span>).scale(domain<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">9</span>)),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  alt.Y(<span class="st">'sepal width (cm):Q'</span>).scale(domain<span class="op">=</span>(<span class="fl">1.5</span>,<span class="dv">5</span>)),</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  alt.Color(<span class="st">'target:N'</span>).scale(scheme<span class="op">=</span><span class="st">'dark2'</span>),</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  alt.Shape(<span class="st">'target:N'</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>).interactive()</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>vw <span class="op">=</span> chart1.to_json()</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell fig-cap-location-top">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r display}</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-vega1</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: An interactive plot using python altair</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap-location: top</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as_vegaspec</span>(py<span class="sc">$</span>vw)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-vega1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div id="htmlwidget-050ea9dd777556b04fb4" style="width:auto;height:auto;" class="vegawidget-vl5 html-widget "></div>
<script type="application/json" data-for="htmlwidget-050ea9dd777556b04fb4">{"x":{
  "chart_spec": {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.8.0.json",
    "config": {
      "view": {
        "continuousHeight": 300,
        "continuousWidth": 300
      }
    },
    "data": {
      "name": "data-efc8798eb98fb6669c53b4eb56ce3b24"
    },
    "datasets": {
      "data-efc8798eb98fb6669c53b4eb56ce3b24": [
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.7000000000000002,
          "sepal width (cm)": 3.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.5999999999999996,
          "sepal width (cm)": 3.1000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.6000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3.8999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 4.5999999999999996,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.4000000000000004,
          "sepal width (cm)": 2.8999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.10000000000000001,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3.7000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.7999999999999998,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.10000000000000001,
          "sepal length (cm)": 4.7999999999999998,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.1000000000000001,
          "petal width (cm)": 0.10000000000000001,
          "sepal length (cm)": 4.2999999999999998,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.2,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 4,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 4.4000000000000004,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3.8999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 3.7999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.7999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.7000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.5999999999999996,
          "sepal width (cm)": 3.6000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.7,
          "petal width (cm)": 0.5,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.2999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.8999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.7999999999999998,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.2000000000000002,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.2000000000000002,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.7000000000000002,
          "sepal width (cm)": 3.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.7999999999999998,
          "sepal width (cm)": 3.1000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.10000000000000001,
          "sepal length (cm)": 5.2000000000000002,
          "sepal width (cm)": 4.0999999999999996,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 4.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.2,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.10000000000000001,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 3.6000000000000001,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.4000000000000004,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.3999999999999999,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 4.5,
          "sepal width (cm)": 2.2999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.4000000000000004,
          "sepal width (cm)": 3.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.59999999999999998,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.5,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.8999999999999999,
          "petal width (cm)": 0.40000000000000002,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.7999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.29999999999999999,
          "sepal length (cm)": 4.7999999999999998,
          "sepal width (cm)": 3,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.6000000000000001,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 3.7999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 4.5999999999999996,
          "sepal width (cm)": 3.2000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.5,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5.2999999999999998,
          "sepal width (cm)": 3.7000000000000002,
          "target": "setosa"
        },
        {
          "petal length (cm)": 1.3999999999999999,
          "petal width (cm)": 0.20000000000000001,
          "sepal length (cm)": 5,
          "sepal width (cm)": 3.2999999999999998,
          "target": "setosa"
        },
        {
          "petal length (cm)": 4.7000000000000002,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 7,
          "sepal width (cm)": 3.2000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 3.2000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.9000000000000004,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.9000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.2999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5999999999999996,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7000000000000002,
          "petal width (cm)": 1.6000000000000001,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 3.2999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.2999999999999998,
          "petal width (cm)": 1,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 2.3999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5999999999999996,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.5999999999999996,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.8999999999999999,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 5.2000000000000002,
          "sepal width (cm)": 2.7000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.5,
          "petal width (cm)": 1,
          "sepal length (cm)": 5,
          "sepal width (cm)": 2,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2000000000000002,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.9000000000000004,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.2000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7000000000000002,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.6000000000000001,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4000000000000004,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3.1000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.0999999999999996,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.7000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.2000000000000002,
          "sepal width (cm)": 2.2000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.8999999999999999,
          "petal width (cm)": 1.1000000000000001,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7999999999999998,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 5.9000000000000004,
          "sepal width (cm)": 3.2000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.9000000000000004,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7000000000000002,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2999999999999998,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4000000000000004,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.5999999999999996,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7999999999999998,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.7999999999999998,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.7,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.5,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 2.6000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.7999999999999998,
          "petal width (cm)": 1.1000000000000001,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.3999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.7000000000000002,
          "petal width (cm)": 1,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.3999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.8999999999999999,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.7000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 1.6000000000000001,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.7000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 5.4000000000000004,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.6000000000000001,
          "sepal length (cm)": 6,
          "sepal width (cm)": 3.3999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.7000000000000002,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3.1000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4000000000000004,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.2999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.0999999999999996,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.4000000000000004,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.5,
          "sepal width (cm)": 2.6000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.5999999999999996,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.6000000000000001,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3.2999999999999998,
          "petal width (cm)": 1,
          "sepal length (cm)": 5,
          "sepal width (cm)": 2.2999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2000000000000002,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 2.7000000000000002,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2000000000000002,
          "petal width (cm)": 1.2,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 3,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2000000000000002,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.2999999999999998,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 6.2000000000000002,
          "sepal width (cm)": 2.8999999999999999,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 3,
          "petal width (cm)": 1.1000000000000001,
          "sepal length (cm)": 5.0999999999999996,
          "sepal width (cm)": 2.5,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 4.0999999999999996,
          "petal width (cm)": 1.3,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 2.7999999999999998,
          "target": "versicolor"
        },
        {
          "petal length (cm)": 6,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 3.2999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 1.8999999999999999,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.7000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.9000000000000004,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 7.0999999999999996,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.8999999999999999,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7999999999999998,
          "petal width (cm)": 2.2000000000000002,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.5999999999999996,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 7.5999999999999996,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.5,
          "petal width (cm)": 1.7,
          "sepal length (cm)": 4.9000000000000004,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.2999999999999998,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 7.2999999999999998,
          "sepal width (cm)": 2.8999999999999999,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7999999999999998,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.0999999999999996,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 7.2000000000000002,
          "sepal width (cm)": 3.6000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 2,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2999999999999998,
          "petal width (cm)": 1.8999999999999999,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 2.7000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 6.7999999999999998,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 2,
          "sepal length (cm)": 5.7000000000000002,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 2.3999999999999999,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2999999999999998,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 3.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.7000000000000002,
          "petal width (cm)": 2.2000000000000002,
          "sepal length (cm)": 7.7000000000000002,
          "sepal width (cm)": 3.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.9000000000000004,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 7.7000000000000002,
          "sepal width (cm)": 2.6000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6,
          "sepal width (cm)": 2.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7000000000000002,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.9000000000000004,
          "sepal width (cm)": 3.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9000000000000004,
          "petal width (cm)": 2,
          "sepal length (cm)": 5.5999999999999996,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.7000000000000002,
          "petal width (cm)": 2,
          "sepal length (cm)": 7.7000000000000002,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9000000000000004,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.7000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7000000000000002,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3.2999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 7.2000000000000002,
          "sepal width (cm)": 3.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.7999999999999998,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.2000000000000002,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.9000000000000004,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7999999999999998,
          "petal width (cm)": 1.6000000000000001,
          "sepal length (cm)": 7.2000000000000002,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.0999999999999996,
          "petal width (cm)": 1.8999999999999999,
          "sepal length (cm)": 7.4000000000000004,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.4000000000000004,
          "petal width (cm)": 2,
          "sepal length (cm)": 7.9000000000000004,
          "sepal width (cm)": 3.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 2.2000000000000002,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 1.5,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.7999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 1.3999999999999999,
          "sepal length (cm)": 6.0999999999999996,
          "sepal width (cm)": 2.6000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 6.0999999999999996,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 7.7000000000000002,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 2.3999999999999999,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 3.3999999999999999,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6.4000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 4.7999999999999998,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 6,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.4000000000000004,
          "petal width (cm)": 2.1000000000000001,
          "sepal length (cm)": 6.9000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.5999999999999996,
          "petal width (cm)": 2.3999999999999999,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3.1000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.9000000000000004,
          "sepal width (cm)": 3.1000000000000001,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 1.8999999999999999,
          "sepal length (cm)": 5.7999999999999998,
          "sepal width (cm)": 2.7000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.9000000000000004,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.7999999999999998,
          "sepal width (cm)": 3.2000000000000002,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.7000000000000002,
          "petal width (cm)": 2.5,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3.2999999999999998,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2000000000000002,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.7000000000000002,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5,
          "petal width (cm)": 1.8999999999999999,
          "sepal length (cm)": 6.2999999999999998,
          "sepal width (cm)": 2.5,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.2000000000000002,
          "petal width (cm)": 2,
          "sepal length (cm)": 6.5,
          "sepal width (cm)": 3,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.4000000000000004,
          "petal width (cm)": 2.2999999999999998,
          "sepal length (cm)": 6.2000000000000002,
          "sepal width (cm)": 3.3999999999999999,
          "target": "virginica"
        },
        {
          "petal length (cm)": 5.0999999999999996,
          "petal width (cm)": 1.8,
          "sepal length (cm)": 5.9000000000000004,
          "sepal width (cm)": 3,
          "target": "virginica"
        }
      ]
    },
    "encoding": {
      "color": {
        "field": "target",
        "scale": {
          "scheme": "dark2"
        },
        "type": "nominal"
      },
      "shape": {
        "field": "target",
        "type": "nominal"
      },
      "x": {
        "field": "sepal length (cm)",
        "scale": {
          "domain": [
            4,
            9
          ]
        },
        "type": "quantitative"
      },
      "y": {
        "field": "sepal width (cm)",
        "scale": {
          "domain": [
            1.5,
            5
          ]
        },
        "type": "quantitative"
      }
    },
    "mark": {
      "type": "point"
    },
    "params": [
      {
        "bind": "scales",
        "name": "param_1",
        "select": {
          "encodings": [
            "x",
            "y"
          ],
          "type": "interval"
        }
      }
    ]
  },
  "embed_options": {
    "renderer": "canvas",
    "defaultStyle": true
  }
},"evals":[],"jsHooks":[]}</script><figcaption class="figure-caption">Figure&nbsp;1: An interactive plot using python altair</figcaption></figure>
</div>
</div>
<p>Alternatively, we can use <code>ggplot2</code> R package + python data to plot the scatter plots, which I prefer.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="do">## A function to convert python iris to R version of iris</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>tidy_python_data <span class="ot">&lt;-</span> <span class="cf">function</span>(iris_from_python) {</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> iris_from_python<span class="sc">$</span>data</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">apply</span>(dat, <span class="dv">2</span>, as.numeric)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> iris_from_python<span class="sc">$</span>feature_names</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  Species <span class="ot">=</span> <span class="fu">as.character</span>(<span class="fu">factor</span>(iris_from_python<span class="sc">$</span>target, <span class="at">labels =</span> iris_from_python<span class="sc">$</span>target_names))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(dat, <span class="at">Species =</span> Species))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>Species, \(x) <span class="fu">as.numeric</span>(x)))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  dat</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emojifont)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>iris_from_python <span class="ot">=</span> <span class="fu">tidy_python_data</span>(<span class="at">iris_from_python =</span> py<span class="sc">$</span>iris_data)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris_from_python) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">sepal length (cm)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">sepal width (cm)</span><span class="st">`</span>, <span class="at">color =</span> Species, <span class="at">shape =</span> Species), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Sepal'</span>, <span class="at">caption =</span> <span class="st">'Love you Melody  ♥ !'</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Dark2'</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris_from_python) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">petal length (cm)</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">petal width (cm)</span><span class="st">`</span>, <span class="at">color =</span> Species, <span class="at">shape =</span> Species), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'Petal'</span>, <span class="at">caption =</span> <span class="st">'Love you Melody  ♥ !'</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">'Dark2'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It appears that its hard to differentiate versicolor with verginica in terms of sepal and petal but setosa is more smaller in petal width/length and sepal length but relative long sepal width.</p>
</section><section id="pure-r-torch-for-r" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="pure-r-torch-for-r">
<span class="header-section-number">4</span> Pure R: torch for R</h2>
<p>Alternatively, there is a R package called <a href="https://torch.mlverse.org/start/guess_the_correlation/"><code>torch</code></a>, which is built directly on top of libtorch, a C++ library that provides the tensor-computation and automatic-differentiation capabilities. However, to the date I wrote this post, the version of torch is 0.11.0, which suggests that the package is still far from well developed.</p>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(torch)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(luz)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(torchvision)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># torch_tensor(1, device = 'cpu')</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="JihongZ/quarto-academic-jihong" data-repo-id="R_kgDOJz3gyg" data-category="General" data-category-id="DIC_kwDOJz3gys4CXdYE" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2015-2023, <span class="citation" data-cites="JihongZ">@JihongZ</span></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>