<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jihong Zhang">
<meta name="dcterms.date" content="2023-06-10">
<title>Dr.&nbsp;Jihong Zhang - Latent Class Model: Batch Mplus using R on Mac</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-149871707-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script><link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Maven+Pro:wght@400&amp;display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/key-buttons.min.js" defer=""></script><link href="https://cdn.jsdelivr.net/npm/@xiee/utils/css/key-buttons.min.css" rel="stylesheet">
<meta property="og:title" content="Dr.&nbsp;Jihong Zhang - Latent Class Model: Batch Mplus using R on Mac">
<meta property="og:description" content="To make sure Mplus can been successfully called in R, the very first thing is checking whether your MacOS can use command-line version of Mplus.">
<meta property="og:site-name" content="Dr. Jihong Zhang">
<meta name="twitter:title" content="Dr.&nbsp;Jihong Zhang - Latent Class Model: Batch Mplus using R on Mac">
<meta name="twitter:description" content="To make sure Mplus can been successfully called in R, the very first thing is checking whether your MacOS can use command-line version of Mplus.">
<meta name="twitter:creator" content="@jihongzgamma">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html">Blog</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-more" role="button" data-bs-toggle="dropdown" aria-expanded="false">More</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-more">
<li>
    <a class="dropdown-item" href="../../projects.html">
 <span class="dropdown-text">projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../links.html">
 <span class="dropdown-text">About</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 </a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#requirement" id="toc-requirement" class="nav-link active" data-scroll-target="#requirement">Requirement</a></li>
  <li>
<a href="#latent-class-analysis" id="toc-latent-class-analysis" class="nav-link" data-scroll-target="#latent-class-analysis">Latent Class Analysis</a>
  <ul class="collapse">
<li><a href="#an-example" id="toc-an-example" class="nav-link" data-scroll-target="#an-example">An example</a></li>
  <li><a href="#batch-lca-in-r-select-number-of-latent-classes" id="toc-batch-lca-in-r-select-number-of-latent-classes" class="nav-link" data-scroll-target="#batch-lca-in-r-select-number-of-latent-classes">Batch LCA in R: select number of latent classes</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Latent Class Model: Batch Mplus using R on Mac</h1>
  <div class="quarto-categories">
    <div class="quarto-category">blog</div>
    <div class="quarto-category">LCM</div>
    <div class="quarto-category">R</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jihong Zhang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 10, 2023</p>
    </div>
  </div>
    
  </div>
  

</header><div class="cell">

</div>
<blockquote class="blockquote">
<p><a href="https://www.statmodel.com/glance.shtml">Mplus</a> is a very popular program for varied latent varaible modeling: (1) Structural equation modeling (2) multilevel analysis (3) mixture modeling (latent class model). R, in the other hand, is a general statistical programming language which not limits to certain statistical models. However, there are scarcely online resources illustrate how to run Mplus using R on Mac.</p>
</blockquote>
<section id="requirement" class="level2"><h2 class="anchored" data-anchor-id="requirement">Requirement</h2>
<p>To make sure Mplus can been successfully called in R, the very first thing is checking whether your MacOS can use command-line version of Mplus. Simply type <code>Mplus</code> command in your terminal app on Mac, if you see “Mplus VERSION (Mac)”, then Mplus on MacOS should work and can be called within R. Otherwise, you should check whether you install Mplus software successfully beforehand.</p>
<p><img src="figures/fig1-terminal-mplus.png" class="img-fluid"></p>
<p>Second, you should install R + Rstudio (Optional). Rstudio is optional but strongly recommended.</p>
<p>Third, <code>MplusAutomation</code> package should also been installed in R:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://michaelhallquist.github.io/MplusAutomation/">MplusAutomation</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"MplusAutomation"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span> <span class="co"># for map functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DavisVaughan/furrr">furrr</a></span><span class="op">)</span> <span class="co"># for parallel map</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If everything looks good, we are ready to go.</p>
</section><section id="latent-class-analysis" class="level2"><h2 class="anchored" data-anchor-id="latent-class-analysis">Latent Class Analysis</h2>
<p>A vanilla Mplus input file for latent class model look like followings:</p>
<div class="cell">
<pre class="mplus cell-code"><code>TITLE:
Batch Analysis of Latent Class Models;
DATA:
FILE = "Code/Mplus/datFile.dat";
 
VARIABLE:
NAMES = Male Age Chinese EduF_Med EduF_High EduM_Med EduM_High EduS_Med EduS_High YM
     HY SD PSD YASB YRCS YO YCR SEN Subgroup CE1 SC1 SI1 YCDC1 CLDH1; 
 MISSING=.;
 
      CATEGORICAL = Male-SEN;
      CLASSES = c(10);
      AUXILIARY = CE1-CLDH1 (R3STEP);
      
ANALYSIS:

      TYPE = MIXTURE;
      
OUTPUT:
TECH1 TECH8 TECH11;
SAVEDATA:

      FILE IS model1_savedata.txt;
      SAVE IS cprob;
      FORMAT IS free;</code></pre>
</div>
<p>It looks very cumbersome to write one by one line by hand. For example, <code>VARIABLE &gt; NAMES</code> in Mplus input file contains all indicators and auxiliary variables used for latent class modeling. Any typos may give rise to Mplus throwing out error messages in the estimation.</p>
<p>Thankfully, there’s no need to write the Mplus syntax manually in text editor. Instead, you can write R code to automatically compile Mplus input files for you. In the following sections, I will illustrate how to do that using a real example.</p>
<section id="an-example" class="level3"><h3 class="anchored" data-anchor-id="an-example">An example</h3>
<p>The example makes use of a data set including nine variables of demographic variables of youth, such as gender, age, ethnicity, education levels for father, mother and self etc. The goal is to cluster youth into multiple latent classes based on their demographic characteristics.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"exampleDat.csv"</span>, row.names <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,175
Columns: 9
$ Male      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, …
$ Age       &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Chinese   &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ EduF_Med  &lt;int&gt; 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, …
$ EduF_High &lt;int&gt; 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, …
$ EduM_Med  &lt;int&gt; 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …
$ EduM_High &lt;int&gt; 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, …
$ EduS_Med  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ EduS_High &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
<p>Using <code>mplusObject</code> function, we can create a R object (or a Mplus model object stored in R), which holds all necessary sections for Mplus input syntax of latent class modeling. As shown in the code chunk below, users specify each Mplus section by assigning text strings to arguments. The only difference is that we don’t have to put variables’ names into a text file, instead, we can assign a R dataframe - <code>dat</code> to this model object directly. Then, it can be read by <code>mplusModeler</code> function later to run a latent class model with 2 latent classes.</p>
<p>In other words, we assigned text strings to three arguments -<code>VARIABLE</code>, <code>ANALYSIS</code>, <code>SAVEDATA</code> in mplusObject, which correspond to the sections in Mplus input file. Moreover, the most convenient part of MplusAutomation is allowing users to input variables’ names directly (<code>usevariables = colnames(dat)</code>). That is, <code>rdata</code> and <code>usevariables</code> arguments can be used to specify the variables’ names used for LCA in Mplus, which is equal to <code>NAMES =</code> in vanilla mplus input file.</p>
<p>After we run and extract Mplus results using <code>mplusModeler</code> function, the next step is to parse and extract results from another Mplus model object with results - <code>res_m1</code>. Here, I’m interested in model fit indices of the model, then I can use <code>get_summaries</code> function in R to extract those information of this 2-class latent class model. Pretty neat, right?</p>
<div class="cell" data-hash="index.en_cache/html/unnamed-chunk-2_a2bb16addbc5b11c5a87531726a1b1ab">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#------------#</span></span>
<span><span class="co"># 2-class model</span></span>
<span><span class="co">#------------#</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusObject.html">mplusObject</a></span><span class="op">(</span></span>
<span>  TITLE <span class="op">=</span> <span class="st">"Latent Class Models using R;"</span>,</span>
<span>  VARIABLE <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">  CATEGORICAL = Male-EduS_High;</span></span>
<span><span class="st">  CLASSES = c(2);"</span>,</span>
<span>  ANALYSIS <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">    TYPE = MIXTURE;</span></span>
<span><span class="st">    ALGORITHM = INTEGRATION;</span></span>
<span><span class="st">    STARTS = 500 20;</span></span>
<span><span class="st">  "</span>,</span>
<span>  SAVEDATA <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">    FILE IS LCA_M1_save.txt;</span></span>
<span><span class="st">    SAVE IS cprob;</span></span>
<span><span class="st">    FORMAT IS free;</span></span>
<span><span class="st">  "</span>,</span>
<span>  OUTPUT <span class="op">=</span> <span class="st">"TECH1 TECH8;"</span>,</span>
<span>  rdata <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,</span>
<span>  autov <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="va">res_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusModeler.html">mplusModeler</a></span><span class="op">(</span><span class="va">m1</span>, modelout <span class="op">=</span> <span class="st">"Mplus/model.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summary_m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/get_results.html">get_summaries</a></span><span class="op">(</span><span class="va">res_m1</span>, simplify <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">kbl</span><span class="op">(</span><span class="va">summary_m1</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable_material_dark</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Maven Pro"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condensed"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-material-dark table table-condensed table-hover" style="font-family: Maven Pro; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:left;"> Model_1 </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> Mplus.version </td>
   <td style="text-align:left;"> 8.7 </td>
  </tr>
<tr>
<td style="text-align:left;"> Title </td>
   <td style="text-align:left;"> Latent Class Models using R; </td>
  </tr>
<tr>
<td style="text-align:left;"> AnalysisType </td>
   <td style="text-align:left;"> MIXTURE </td>
  </tr>
<tr>
<td style="text-align:left;"> DataType </td>
   <td style="text-align:left;"> INDIVIDUAL </td>
  </tr>
<tr>
<td style="text-align:left;"> Estimator </td>
   <td style="text-align:left;"> MLR </td>
  </tr>
<tr>
<td style="text-align:left;"> Observations </td>
   <td style="text-align:left;"> 2175 </td>
  </tr>
<tr>
<td style="text-align:left;"> NGroups </td>
   <td style="text-align:left;"> 1 </td>
  </tr>
<tr>
<td style="text-align:left;"> NDependentVars </td>
   <td style="text-align:left;"> 9 </td>
  </tr>
<tr>
<td style="text-align:left;"> NIndependentVars </td>
   <td style="text-align:left;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> NContinuousLatentVars </td>
   <td style="text-align:left;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> NCategoricalLatentVars </td>
   <td style="text-align:left;"> 1 </td>
  </tr>
<tr>
<td style="text-align:left;"> Parameters </td>
   <td style="text-align:left;"> 19 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalPearson_Value </td>
   <td style="text-align:left;"> 2255.894 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalPearson_DF </td>
   <td style="text-align:left;"> 491 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalPearson_PValue </td>
   <td style="text-align:left;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalLRT_Value </td>
   <td style="text-align:left;"> 1669.323 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalLRT_DF </td>
   <td style="text-align:left;"> 491 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqCategoricalLRT_PValue </td>
   <td style="text-align:left;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedPearson_Value </td>
   <td style="text-align:left;"> 54.839 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedPearson_DF </td>
   <td style="text-align:left;"> 637 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedPearson_PValue </td>
   <td style="text-align:left;"> 1 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedLRT_Value </td>
   <td style="text-align:left;"> 26.06 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedLRT_DF </td>
   <td style="text-align:left;"> 637 </td>
  </tr>
<tr>
<td style="text-align:left;"> ChiSqMCARUnrestrictedLRT_PValue </td>
   <td style="text-align:left;"> 1 </td>
  </tr>
<tr>
<td style="text-align:left;"> LL </td>
   <td style="text-align:left;"> -8527.781 </td>
  </tr>
<tr>
<td style="text-align:left;"> LLCorrectionFactor </td>
   <td style="text-align:left;"> 1.0086 </td>
  </tr>
<tr>
<td style="text-align:left;"> AIC </td>
   <td style="text-align:left;"> 17093.562 </td>
  </tr>
<tr>
<td style="text-align:left;"> BIC </td>
   <td style="text-align:left;"> 17201.573 </td>
  </tr>
<tr>
<td style="text-align:left;"> aBIC </td>
   <td style="text-align:left;"> 17141.207 </td>
  </tr>
<tr>
<td style="text-align:left;"> Entropy </td>
   <td style="text-align:left;"> 0.936 </td>
  </tr>
<tr>
<td style="text-align:left;"> AICC </td>
   <td style="text-align:left;"> 17093.9146682135 </td>
  </tr>
<tr>
<td style="text-align:left;"> Filename </td>
   <td style="text-align:left;"> model.out </td>
  </tr>
<tr>
<td style="text-align:left;"> NLatentClasses </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>This is a simplistic procedure for one model. What about a bunch of models?</p>
</section><section id="batch-lca-in-r-select-number-of-latent-classes" class="level3"><h3 class="anchored" data-anchor-id="batch-lca-in-r-select-number-of-latent-classes">Batch LCA in R: select number of latent classes</h3>
<p>One most important step of latent class analysis is to select the number of latent classes, which best summarize the data. This research question can be translated to “when we have multiple alternative latent class models with different number of latent class (C), which one has optimal model fit”. The general rule of model selection is using information criterion such as AIC, BIC. Alternatively, model comparison method such as likelihood ratio test can be used to compare nested models. Here, I created a function to batch run multiple LCA across different number of classes to select the optimal models.</p>
<div class="cell" data-hl_lines="[1,3]" data-linenos="[&quot;function (..., exclude = if (useNA == &quot;no&quot;) c(NA, NaN), useNA = c(&quot;no&quot;, &quot;,&quot;    &quot;ifany&quot;, &quot;always&quot;), dnn = list.names(...), deparse.level = 1) &quot;,&quot;{&quot;,&quot;    list.names <- function(...) {&quot;,&quot;        l <- as.list(substitute(list(...)))[-1L]&quot;,&quot;        if (length(l) == 1L &amp;&amp; is.list(..1) &amp;&amp; !is.null(nm <- names(..1))) &quot;,&quot;            return(nm)&quot;,&quot;        nm <- names(l)&quot;,&quot;        fixup <- if (is.null(nm)) &quot;,&quot;            seq_along(l)&quot;,&quot;        else nm == &quot;&quot;&quot;,&quot;        dep <- vapply(l[fixup], function(x) switch(deparse.level + &quot;,&quot;            1, &quot;&quot;, if (is.symbol(x)) as.character(x) else &quot;&quot;, &quot;,&quot;            deparse(x, nlines = 1)[1L]), &quot;&quot;)&quot;,&quot;        if (is.null(nm)) &quot;,&quot;            dep&quot;,&quot;        else {&quot;,&quot;            nm[fixup] <- dep&quot;,&quot;            nm&quot;,&quot;        }&quot;,&quot;    }&quot;,&quot;    miss.use <- missing(useNA)&quot;,&quot;    miss.exc <- missing(exclude)&quot;,&quot;    useNA <- if (miss.use &amp;&amp; !miss.exc &amp;&amp; !match(NA, exclude, &quot;,&quot;        nomatch = 0L)) &quot;,&quot;        &quot;ifany&quot;&quot;,&quot;    else match.arg(useNA)&quot;,&quot;    doNA <- useNA != &quot;no&quot;&quot;,&quot;    if (!miss.use &amp;&amp; !miss.exc &amp;&amp; doNA &amp;&amp; match(NA, exclude, &quot;,&quot;        nomatch = 0L)) &quot;,&quot;        warning(&quot;'exclude' containing NA and 'useNA' != \&quot;no\&quot;' are a bit contradicting&quot;)&quot;,&quot;    args <- list(...)&quot;,&quot;    if (length(args) == 1L &amp;&amp; is.list(args[[1L]])) {&quot;,&quot;        args <- args[[1L]]&quot;,&quot;        if (length(dnn) != length(args)) &quot;,&quot;            dnn <- paste(dnn[1L], seq_along(args), sep = &quot;.&quot;)&quot;,&quot;    }&quot;,&quot;    if (!length(args)) &quot;,&quot;        stop(&quot;nothing to tabulate&quot;)&quot;,&quot;    bin <- 0L&quot;,&quot;    lens <- NULL&quot;,&quot;    dims <- integer()&quot;,&quot;    pd <- 1L&quot;,&quot;    dn <- NULL&quot;,&quot;    for (a in args) {&quot;,&quot;        if (is.null(lens)) &quot;,&quot;            lens <- length(a)&quot;,&quot;        else if (length(a) != lens) &quot;,&quot;            stop(&quot;all arguments must have the same length&quot;)&quot;,&quot;        fact.a <- is.factor(a)&quot;,&quot;        if (doNA) &quot;,&quot;            aNA <- anyNA(a)&quot;,&quot;        if (!fact.a) {&quot;,&quot;            a0 <- a&quot;,&quot;            op <- options(warn = 2)&quot;,&quot;            a <- factor(a, exclude = exclude)&quot;,&quot;            options(op)&quot;,&quot;        }&quot;,&quot;        add.na <- doNA&quot;,&quot;        if (add.na) {&quot;,&quot;            ifany <- (useNA == &quot;ifany&quot;)&quot;,&quot;            anNAc <- anyNA(a)&quot;,&quot;            add.na <- if (!ifany || anNAc) {&quot;,&quot;                ll <- levels(a)&quot;,&quot;                if (add.ll <- !anyNA(ll)) {&quot;,&quot;                  ll <- c(ll, NA)&quot;,&quot;                  TRUE&quot;,&quot;                }&quot;,&quot;                else if (!ifany &amp;&amp; !anNAc) &quot;,&quot;                  FALSE&quot;,&quot;                else TRUE&quot;,&quot;            }&quot;,&quot;            else FALSE&quot;,&quot;        }&quot;,&quot;        if (add.na) &quot;,&quot;            a <- factor(a, levels = ll, exclude = NULL)&quot;,&quot;        else ll <- levels(a)&quot;,&quot;        a <- as.integer(a)&quot;,&quot;        if (fact.a &amp;&amp; !miss.exc) {&quot;,&quot;            ll <- ll[keep <- which(match(ll, exclude, nomatch = 0L) == &quot;,&quot;                0L)]&quot;,&quot;            a <- match(a, keep)&quot;,&quot;        }&quot;,&quot;        else if (!fact.a &amp;&amp; add.na) {&quot;,&quot;            if (ifany &amp;&amp; !aNA &amp;&amp; add.ll) {&quot;,&quot;                ll <- ll[!is.na(ll)]&quot;,&quot;                is.na(a) <- match(a0, c(exclude, NA), nomatch = 0L) > &quot;,&quot;                  0L&quot;,&quot;            }&quot;,&quot;            else {&quot;,&quot;                is.na(a) <- match(a0, exclude, nomatch = 0L) > &quot;,&quot;                  0L&quot;,&quot;            }&quot;,&quot;        }&quot;,&quot;        nl <- length(ll)&quot;,&quot;        dims <- c(dims, nl)&quot;,&quot;        if (prod(dims) > .Machine$integer.max) &quot;,&quot;            stop(&quot;attempt to make a table with >= 2^31 elements&quot;)&quot;,&quot;        dn <- c(dn, list(ll))&quot;,&quot;        bin <- bin + pd * (a - 1L)&quot;,&quot;        pd <- pd * nl&quot;,&quot;    }&quot;,&quot;    names(dn) <- dnn&quot;,&quot;    bin <- bin[!is.na(bin)]&quot;,&quot;    if (length(bin)) &quot;,&quot;        bin <- bin + 1L&quot;,&quot;    y <- array(tabulate(bin, pd), dims, dimnames = dn)&quot;,&quot;    class(y) <- &quot;table&quot;&quot;,&quot;    y&quot;,&quot;}&quot;]">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fitMplus</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span> <span class="op">=</span> <span class="va">dat</span>, <span class="va">class</span>, </span>
<span>                     <span class="va">uvars</span> <span class="op">=</span> <span class="st">"Male-EduS_High"</span>, <span class="va">auxvars</span><span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                     <span class="va">modelout</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">savedata</span> <span class="op">=</span> <span class="cn">NULL</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## specify the used variables</span></span>
<span>  <span class="va">fitIndices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LL"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>, <span class="st">"aBIC"</span>, <span class="st">"Entropy"</span>, <span class="st">"T11_LMR_PValue"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">savedata</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">savedata</span> <span class="op">=</span> <span class="st">"Mplus/model_Temp_save.txt"</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">auxvars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">start_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">uvars</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">end_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">auxvars</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">modelTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusObject.html">mplusObject</a></span><span class="op">(</span></span>
<span>      TITLE <span class="op">=</span> <span class="st">"Batch Analysis of Latent Class Models;"</span>,</span>
<span>      VARIABLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">      CATEGORICAL = "</span>, <span class="va">uvars</span>, <span class="st">";</span></span>
<span><span class="st">      CLASSES = c("</span>, <span class="va">class</span>, <span class="st">");</span></span>
<span><span class="st">      AUXILIARY = "</span>, <span class="va">auxvars</span>,<span class="st">" (R3STEP);</span></span>
<span><span class="st">      "</span><span class="op">)</span>,</span>
<span>      ANALYSIS <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">      TYPE = MIXTURE;</span></span>
<span><span class="st">      "</span>,</span>
<span>      SAVEDATA <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">      FILE IS "</span>, <span class="va">savedata</span>,<span class="st">";</span></span>
<span><span class="st">      SAVE IS cprob;</span></span>
<span><span class="st">      FORMAT IS free;</span></span>
<span><span class="st">      "</span><span class="op">)</span>,</span>
<span>      OUTPUT <span class="op">=</span> <span class="st">"TECH1 TECH8 TECH11;"</span>,</span>
<span>      rdata <span class="op">=</span> <span class="va">data</span>,</span>
<span>      usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      autov <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">start_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">uvars</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">end_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="va">uvars</span>, <span class="st">"-"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">modelTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusObject.html">mplusObject</a></span><span class="op">(</span></span>
<span>      TITLE <span class="op">=</span> <span class="st">"Batch Analysis of Latent Class Models;"</span>,</span>
<span>      VARIABLE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">      CATEGORICAL = "</span>, <span class="va">uvars</span>, <span class="st">";</span></span>
<span><span class="st">      CLASSES = c("</span>, <span class="va">class</span>, <span class="st">");</span></span>
<span><span class="st">      "</span><span class="op">)</span>,</span>
<span>      ANALYSIS <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">      TYPE = MIXTURE;</span></span>
<span><span class="st">      "</span>,</span>
<span>      SAVEDATA <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"</span></span>
<span><span class="st">      FILE IS "</span>, <span class="va">savedata</span>,<span class="st">";</span></span>
<span><span class="st">      SAVE IS cprob;</span></span>
<span><span class="st">      FORMAT IS free;</span></span>
<span><span class="st">      "</span><span class="op">)</span>,</span>
<span>      OUTPUT <span class="op">=</span> <span class="st">"TECH1 TECH8 TECH11;"</span>,</span>
<span>      rdata <span class="op">=</span> <span class="va">data</span>,</span>
<span>      usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span><span class="va">start_index</span><span class="op">:</span><span class="va">end_index</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      autov <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">modelout</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="va">resTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusModeler.html">mplusModeler</a></span><span class="op">(</span><span class="va">modelTEMP</span>, modelout <span class="op">=</span> <span class="va">modelout</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="va">resTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/mplusModeler.html">mplusModeler</a></span><span class="op">(</span><span class="va">modelTEMP</span>, modelout <span class="op">=</span> <span class="st">"Mplus/modelTEMP.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">summaryTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://michaelhallquist.github.io/MplusAutomation/reference/get_results.html">get_summaries</a></span><span class="op">(</span><span class="va">resTEMP</span>, simplify <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">summaryTEMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">summaryTEMP</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">summaryTEMP</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">fitIndices</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">summaryTEMP</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">class</span>, <span class="st">"-class Model"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># return</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="va">resTEMP</span>,</span>
<span>    summary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">summaryTEMP</span><span class="op">)</span>  </span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, I ran a series of latent class models with different number of classes (from 2 to 7 latent classes):</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lcmFit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://furrr.futureverse.org/reference/future_map.html">future_map</a></span><span class="op">(</span></span>
<span>  <span class="fl">2</span><span class="op">:</span><span class="fl">7</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">fitMplus</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, class <span class="op">=</span> <span class="va">x</span>, </span>
<span>                     uvars <span class="op">=</span> <span class="st">"Male-EduS_High"</span>,</span>
<span>                     modelout <span class="op">=</span> <span class="st">"Mplus/model1fit.inp"</span>,</span>
<span>                     savedata <span class="op">=</span> <span class="st">"Mplus/model_Temp_save.txt"</span><span class="op">)</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">lcmFit</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable_material_dark</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">F</span>, html_font <span class="op">=</span> <span class="st">"Maven Pro"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"condensed"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-material-dark table table-condensed table-hover" style="font-family: Maven Pro; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">   </th>
   <th style="text-align:right;"> LL </th>
   <th style="text-align:right;"> AIC </th>
   <th style="text-align:right;"> BIC </th>
   <th style="text-align:right;"> aBIC </th>
   <th style="text-align:right;"> Entropy </th>
   <th style="text-align:right;"> T11_LMR_PValue </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> 2-class Model </td>
   <td style="text-align:right;"> -8527.781 </td>
   <td style="text-align:right;"> 17093.56 </td>
   <td style="text-align:right;"> 17201.57 </td>
   <td style="text-align:right;"> 17141.21 </td>
   <td style="text-align:right;"> 0.936 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 3-class Model </td>
   <td style="text-align:right;"> -8240.625 </td>
   <td style="text-align:right;"> 16539.25 </td>
   <td style="text-align:right;"> 16704.11 </td>
   <td style="text-align:right;"> 16611.97 </td>
   <td style="text-align:right;"> 0.952 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 4-class Model </td>
   <td style="text-align:right;"> -8049.198 </td>
   <td style="text-align:right;"> 16176.40 </td>
   <td style="text-align:right;"> 16398.10 </td>
   <td style="text-align:right;"> 16274.19 </td>
   <td style="text-align:right;"> 0.969 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 5-class Model </td>
   <td style="text-align:right;"> -7978.962 </td>
   <td style="text-align:right;"> 16055.92 </td>
   <td style="text-align:right;"> 16334.48 </td>
   <td style="text-align:right;"> 16178.80 </td>
   <td style="text-align:right;"> 0.951 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 6-class Model </td>
   <td style="text-align:right;"> -7917.136 </td>
   <td style="text-align:right;"> 15952.27 </td>
   <td style="text-align:right;"> 16287.67 </td>
   <td style="text-align:right;"> 16100.22 </td>
   <td style="text-align:right;"> 0.990 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> 7-class Model </td>
   <td style="text-align:right;"> -7849.506 </td>
   <td style="text-align:right;"> 15837.01 </td>
   <td style="text-align:right;"> 16229.26 </td>
   <td style="text-align:right;"> 16010.04 </td>
   <td style="text-align:right;"> 0.934 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>As the table shown, 7-class model appears to have the best model fit among 6 alternative models (lowest AIC/BIC/aBIC).</p>
</section></section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p><code>MplusAutomation</code> + R could be good tools for LCA. However, extracting information from Mplus output file is not so easy. For example, when there are auxiliary variables exists, the regression coefficients regressed on latent classes needed to be parsed and extract manually. For example, following functions can be used to extract the regression coefficients of latent class model using the 3-step approach.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#------------#</span></span>
<span><span class="co"># Extract output regression table from R3Step LCA</span></span>
<span><span class="co">#------------#</span></span>
<span><span class="va">extract_r3step</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model_path</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># browser()</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html">read_lines</a></span><span class="op">(</span><span class="va">model_path</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>row1 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'NUMBER OF OBSERVATIONS USED'</span><span class="op">)</span><span class="op">]</span>,</span>
<span>           row2 <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>                                     <span class="st">'^ODDS RATIOS FOR TESTS OF CATEGORICAL LATENT VARIABLE'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">row1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">row2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>type_comparison <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'Parameterization using Reference'</span><span class="op">)</span>,</span>
<span>           type_colname <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'Estimate'</span><span class="op">)</span>,</span>
<span>           type_classnum <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'C#[0-9]+'</span><span class="op">)</span>,</span>
<span>           type_predictor <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'[\\.\\-0-9]+[\\s]+[\\.\\-0-9]+'</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">type_classnum</span>, <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>           predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">type_predictor</span>, <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">parse_predictors</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           comparison_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">type_comparison</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">comparison_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">type_classnum</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>comparison_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">comparison_group</span> <span class="op">==</span> <span class="fl">0</span>, </span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">class</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">comparison_group</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">comparison_group</span>, <span class="va">class_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">class_group</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class_group2 <span class="op">=</span> <span class="va">class</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">type_predictor</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">comparison_group</span>, <span class="va">class_group2</span>, <span class="va">predictors</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>comparison_class <span class="op">=</span> <span class="va">comparison_group</span>,</span>
<span>           class <span class="op">=</span> <span class="va">class_group2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,</span>
<span>           se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>           tval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">tval</span><span class="op">)</span>,</span>
<span>           pval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pval</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="co">#------------#</span></span>
<span><span class="co"># Read in save data from Mplus</span></span>
<span><span class="co">#------------#</span></span>
<span><span class="va">read_saveddata</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">path_output</span>, <span class="va">path_savedata</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## extract data and latent classes</span></span>
<span>  <span class="va">mplusOuput</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span><span class="op">(</span><span class="va">path_output</span><span class="op">)</span></span>
<span>  <span class="va">top</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">mplusOuput</span>, <span class="st">"Order of variables"</span><span class="op">)</span><span class="op">)</span> <span class="co"># start linenumber</span></span>
<span>  <span class="va">bottom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">mplusOuput</span>, <span class="st">"Save file format"</span><span class="op">)</span><span class="op">)</span> <span class="co"># end linenumber</span></span>
<span>  <span class="va">rawVars</span> <span class="op">&lt;-</span> <span class="va">mplusOuput</span><span class="op">[</span><span class="op">(</span><span class="va">top</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">bottom</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">savevarnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/trimws.html">trimws</a></span><span class="op">(</span><span class="va">rawVars</span><span class="op">[</span><span class="va">rawVars</span> <span class="op">!=</span> <span class="st">""</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## read saved data from Mplus output</span></span>
<span>  <span class="va">savedDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">path_savedata</span>, na.strings <span class="op">=</span> <span class="st">"*"</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                         col.names <span class="op">=</span> <span class="va">savevarnames</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">savedDat</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hope this is helpful.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><script src="https://giscus.app/client.js" data-repo="JihongZ/quarto-academic-jihong" data-repo-id="R_kgDOJz3gyg" data-category="General" data-category-id="DIC_kwDOJz3gys4CXdYE" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>